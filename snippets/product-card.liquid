{% doc %}
  Renders a Product Card component.

  @param {string} title - Product title
  @param {object} image - The image object containing the source and alt text.
  @param {object} [swap_image] - The image to swap to when hover effect set to swap.
  @param {string} [badge] - Optional Badge to render on the product card.
  @param {number} [compare_at_price] - Product compare at price in cents.
  @param {number} price - Product price in cents.
  @param {string} url - URL of the Product.
  @param {number} [rating] - Product rating.
  @param {string} [hover_effect] - The hover effect for the image. ('none', 'swap', 'zoom')
  @param {boolean} [quick_add] - Renders a quick add button to the product card.
{% enddoc %}

{% assign hover_effect = hover_effect | default: settings.product_card_hover_effect %}

<article
  class="
    ProductCard
    ProductCard--Hover{{ hover_effect | camelcase }}
  "
>
  <a href="{{ url }}">
    <div class="ProductCard__Image">
      {% render 'image', image: image, variant: 'square' %}

      {% if hover_effect == 'swap' and swap_image %}
        {% render 'image', image: swap_image, variant: 'square' %}
      {% endif %}

      <div class="ProductCard__Badges">
        <ul class="u-NoList BadgeList BadgeList--AlignRight">
          {% if badge %}
            <li>
              {% render 'badge', text: badge %}
            </li>
          {% endif %}

          {% if compare_at_price > price %}
            <li>
              {% render 'badge', text: 'Sale', variant: 'sale' %}
            </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </a>

  <div class="ProductCard__Bottom">
    <div class="ProductCard__Details">
      <a href="{{ url }}">
        {% render 'text', text: title, as: 'b' %}
      </a>

      {% if rating %}
        {% render 'rating', rating: rating %}
      {% endif %}

      <div class="ProductCard__PriceList">
        {% render 'price-list', price: price, compare_at_price: compare_at_price %}
      </div>
    </div>

    {% if quick_add %}
      <div class="ProductCard__Actions">
        {% render 'button', icon: 'shopping-cart', size: 'small' %}
      </div>
    {% endif %}
  </div>
</article>

{% stylesheet %}
  .ProductCard {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: var(--size-xs);
    background-color: var(--t-background);
    background: var(--t-gradient-background);
    border: var(--border-width) solid var(--t-border-card);
    border-top-color: var(--t-highlight);
    border-radius: var(--t-border-radius);
    box-shadow: var(--box-shadow);
    overflow: hidden;
  }

  .ProductCard__Image {
    position: relative;

    /* Make sure the image doesnt overflow its container */
    overflow: hidden;
  }

  .ProductCard--HoverZoom .ProductCard__Image .Image {
    transform: scale(0.8);
    transition: var(--transition-duration-medium) var(--transition-timing);
  }

  .ProductCard--HoverZoom .ProductCard__Image:hover .Image {
    transform: scale(1);
  }

  .ProductCard--HoverSwap:has(.Image:nth-of-type(2)) .ProductCard__Image .Image {
    transition: transform var(--transition-duration-short) var(--transition-timing);
  }

  .ProductCard--HoverSwap:has(.Image:nth-of-type(2)) .ProductCard__Image .Image:first-of-type {
    transform: translateX(0);
  }

  .ProductCard--HoverSwap:has(.Image:nth-of-type(2)) .ProductCard__Image:hover .Image:first-of-type {
    transform: translateX(-100%);
  }

  .ProductCard--HoverSwap:has(.Image:nth-of-type(2)) .ProductCard__Image .Image:nth-of-type(2) {
    position: absolute;
    inset: 0;

    /* Add 1px to the translate to account for fractional pixels that might get rounded by the browser and would lead
    to the second image being barely visible. */
    transform: translateX(calc(100% + 1px));
  }

  .ProductCard--HoverSwap:has(.Image:nth-of-type(2)) .ProductCard__Image:hover .Image:nth-of-type(2) {
    transform: translateX(0);
  }

  .ProductCard__Actions {
  }

  .ProductCard__Badges {
    position: absolute;
    top: 0;
    right: 0;
    padding: var(--size-xs);
  }

  .ProductCard__Bottom {
    display: flex;
    align-items: center;
    width: 100%;
    padding: var(--size-s);
  }

  .ProductCard__Details {
    /* Make sure the details section takes up the remaining space */
    flex: 1;

    display: flex;
    flex-direction: column;
    gap: var(--size-xs);
  }

  .ProductCard__PriceList {
    margin-top: auto;
  }
{% endstylesheet %}
